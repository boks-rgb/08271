<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>오늘의 따뜻한 생각</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background: linear-gradient(to bottom, #fff6e5, #f0faff);
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    h1, h2 {
      color: #ff8c42;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    .input-group, .message-group, .diary-group {
      margin: 20px 0;
    }
    button.shape-btn {
      font-size: 24px;
      margin: 0 10px;
      cursor: pointer;
      background: none;
      border: none;
    }
    .card {
      background-color: #ffe3ec;
      padding: 20px;
      border-radius: 16px;
      margin-top: 20px;
      font-size: 18px;
      color: #d1495b;
      font-weight: bold;
      border: 2px dashed #ffa3b1;
    }
    textarea {
      width: 100%;
      height: 100px;
      padding: 10px;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #ccc;
      resize: none;
    }
    .calendar-wrapper {
      display: flex;
      justify-content: center;
      margin-top: 40px;
    }
    .calendar-group {
      background: white;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      width: fit-content;
    }
    #calendar {
      margin: 0 auto;
      border-collapse: collapse;
    }
    #calendar td {
      width: 30px;
      height: 30px;
      text-align: center;
      font-weight: bold;
      position: relative;
    }
    .written {
      background-color: #c2f0c2;
      border-radius: 50%;
    }
    .written::after {
      content: "💎";
      position: absolute;
      top: 2px;
      right: 2px;
      font-size: 12px;
    }
    .progress-bar {
      width: 100%;
      height: 20px;
      background-color: #eee;
      border-radius: 10px;
      overflow: hidden;
      margin-top: 15px;
    }
    .progress-bar-fill {
      height: 100%;
      background-color: #88e0aa;
      text-align: center;
      color: #333;
      font-size: 14px;
      line-height: 20px;
    }
    .download-btn, .share-btn {
      margin-top: 10px;
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      background-color: #ffa07a;
      color: white;
      cursor: pointer;
      margin-right: 10px;
    }
  </style>
</head>
<body>
  <div class="container" id="capture">
    <h1>오늘의 따뜻한 생각</h1>
    <div class="input-group">
      <p>오늘 날짜: <span id="date"></span></p>
      <input type="text" id="name" placeholder="이름을 입력하세요 😊" />
    </div>

    <div class="message-group">
      <p>좋아하는 모양을 골라주세요 💖</p>
      <button class="shape-btn" onclick="showMessage()">🐰</button>
      <button class="shape-btn" onclick="showMessage()">⭐</button>
      <button class="shape-btn" onclick="showMessage()">🦕</button>
      <button class="shape-btn" onclick="showMessage()">❤️</button>

      <div id="messageCard" class="card" style="display: none;">
        <strong>선생님이 전하는 오늘의 따뜻한 말 🌼</strong>
        <p id="messageWithName" style="margin-top:10px;"></p>
      </div>
    </div>

    <div class="diary-group">
      <p>이 말씀을 듣고 어떤 생각이 들었나요?</p>
      <textarea id="thoughts" placeholder="자신의 생각을 자유롭게 적어보세요."></textarea>
      <p>내일의 다짐 한 줄 🌱</p>
      <textarea id="pledge" placeholder="예: 내일은 더 밝게 인사하기!"></textarea>
      <button class="download-btn" onclick="downloadImage()">이미지로 저장하기</button>
      <button class="share-btn" onclick="shareLink()">링크로 공유하기</button>
    </div>
  </div>

  <div class="calendar-wrapper">
    <div class="calendar-group">
      <h2>나의 생각 달력 🗓️</h2>
      <table id="calendar"></table>
      <div class="progress-bar">
        <div id="progressFill" class="progress-bar-fill" style="width: 0%;">0%</div>
      </div>
      <p id="participationText">참여도를 높여 <strong>보석도장</strong>을 모아보세요! 💎✨</p>
    </div>
  </div>

  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <script>
    const messages = [
      "넌 정말 특별한 아이야. 오늘도 최선을 다해서 멋져!",
      "작은 일도 소중히 하는 너의 마음이 참 예뻐.",
      "힘들어도 꿋꿋하게 해낸 너, 정말 자랑스러워.",
      "네가 웃으면 세상이 더 환해져. 고마워.",
      "오늘의 너는 더 빛나 보여!",
      "어떤 일이든 너라면 해낼 수 있어!",
      "너의 마음은 정말 따뜻해.",
      "너의 노력은 반드시 좋은 결과로 돌아올 거야.",
      "오늘도 열심히 살아가는 너, 멋져!",
      "네가 있다는 것만으로도 소중해.",
      "작은 친절도 큰 사랑이 될 수 있어. 고마워.",
      "오늘도 웃는 얼굴로 시작해줘서 고마워.",
      "실수해도 괜찮아. 그게 성장의 과정이야.",
      "너의 진심이 항상 전해지고 있어.",
      "매일매일 너는 더 멋져지고 있어.",
      "오늘도 포기하지 않고 해낸 너, 최고야!",
      "생각이 깊은 너, 정말 훌륭해.",
      "함께여서 더 즐거워. 고마워.",
      "항상 밝게 인사하는 네 모습이 예뻐.",
      "기분이 울적해도 넌 잘 이겨낼 수 있어.",
      "좋은 하루가 될 거야. 기대해도 좋아!",
      "넌 항상 최선을 다해서 멋져.",
      "용기를 낸 너, 참 대단해.",
      "언제나 노력하는 너를 응원해!",
      "마음이 따뜻한 너와 함께여서 좋아.",
      "오늘도 너의 웃음 덕분에 기분 좋아졌어.",
      "네가 곁에 있어서 다들 행복해.",
      "네가 보여준 정성, 모두 느껴졌어.",
      "오늘도 좋은 하루 보내길 바랄게!",
      "어떤 상황에서도 넌 충분히 소중한 아이야."
    ];

    function showMessage() {
      const random = Math.floor(Math.random() * messages.length);
      const name = document.getElementById("name").value.trim();
      const baseMessage = messages[random];
      const messageText = name ? `${name} ❤️  ${baseMessage}` : baseMessage;
      document.getElementById("messageWithName").innerText = messageText;
      document.getElementById("messageCard").style.display = 'block';
      markCalendar();
    }

    function downloadImage() {
      html2canvas(document.getElementById("capture")).then(canvas => {
        const link = document.createElement("a");
        link.download = `오늘의_따뜻한_생각_${new Date().toISOString().slice(0, 10)}.png`;
        link.href = canvas.toDataURL();
        link.click();
      });
    }

    function shareLink() {
      const url = window.location.href;
      navigator.clipboard.writeText(url).then(() => {
        alert("링크가 복사되었어요! 친구에게 붙여넣기 해보세요 🎉");
      });
    }

    function setDate() {
      const today = new Date();
      const formatted = today.toISOString().slice(0, 10);
      document.getElementById("date").innerText = formatted;
    }

    function markCalendar() {
      const today = new Date();
      const day = today.getDate();
      const cell = document.getElementById("day-" + day);
      if (cell && !cell.classList.contains("written")) {
        cell.classList.add("written");
        cell.innerText = "✅";
        updateProgress();
      }
    }

    function updateProgress() {
      const total = document.querySelectorAll("#calendar td").length;
      const written = document.querySelectorAll("#calendar .written").length;
      const percent = Math.round((written / total) * 100);
      const fill = document.getElementById("progressFill");
      fill.style.width = percent + "%";
      fill.innerText = percent + "%";
    }

    function createCalendar() {
      const today = new Date();
      const year = today.getFullYear();
      const month = today.getMonth();
      const first = new Date(year, month, 1);
      const last = new Date(year, month + 1, 0);

      let html = "<tr>";
      for (let i = 0; i < first.getDay(); i++) html += "<td></td>";

      for (let d = 1; d <= last.getDate(); d++) {
        const weekday = (first.getDay() + d - 1) % 7;
        html += `<td id="day-${d}">${d}</td>`;
        if (weekday === 6) html += "</tr><tr>";
      }

      document.getElementById("calendar").innerHTML = html;
    }

    window.onload = () => {
      setDate();
      createCalendar();
      updateProgress();
    }
  </script>
</body>
</html>
